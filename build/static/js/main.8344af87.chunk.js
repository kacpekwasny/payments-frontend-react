(this["webpackJsonpmy-react-app"]=this["webpackJsonpmy-react-app"]||[]).push([[0],{28:function(e,t,n){},48:function(e,t,n){},50:function(e,t,n){},56:function(e,t,n){},57:function(e,t,n){},58:function(e,t,n){},59:function(e,t,n){},60:function(e,t,n){},61:function(e,t,n){},62:function(e,t,n){},63:function(e,t,n){},64:function(e,t,n){"use strict";n.r(t);var a=n(1),s=n.n(a),c=n(29),r=n.n(c),o=(n(48),n(2)),i=n.n(o),u=n(7),m=n(30),l=n(31),d=n(4),h=n(43),j=n(41),p=n(14),b=n(3),y=n(21),O=n(33),f=n(35),v=n(66);function x(e){y.a.changeLanguage(e)}y.a.use(O.a).use(f.a).use(v.a).init({backend:{loadPath:"/static/translations/{{lng}}/{{ns}}.json"},fallbackLng:"en",debug:!0,detection:{order:["queryString","cookie"],cache:["cookie"]},interpolation:{escapeValue:!1}});y.a,n(50);var R=n(0),g=function(e){var t=e.username,n=e.saldo,a=e.roomName,s=e.baseURL,c=e.reload;return Object(R.jsxs)("nav",{children:[Object(R.jsxs)("div",{className:"row left",children:[Object(R.jsx)(p.b,{to:"".concat(s,"/room-create-pick"),className:"arrow-back",children:"\u27f5"}),Object(R.jsx)("p",{className:"p-username",children:t}),Object(R.jsx)("span",{children:"\xa0:\xa0"}),Object(R.jsx)("p",{className:"p-saldo",children:n}),Object(R.jsx)("button",{onClick:c,className:"reload-arrow clear-bg",type:"button","aria-label":"blah",children:"\u21ba"})]}),Object(R.jsx)("div",{className:"middle",children:Object(R.jsx)("p",{children:a})}),Object(R.jsxs)("div",{className:"row right",children:[Object(R.jsx)("button",{type:"button",className:"pl",onClick:function(){x("pl")},children:"pl"}),Object(R.jsx)("button",{type:"button",className:"en",onClick:function(){x("en")},children:"en"})]})]})},N=(n(56),function(){return Object(R.jsx)("footer",{children:"Footer"})}),k=(n(57),n(28),n(58),function(e){var t=e.onAccept,n=e.payment,a=e.accepted;return Object(R.jsx)("div",{className:"AcceptPaymentButton",children:Object(R.jsx)("p",{children:Object(R.jsx)("button",{className:"AcceptPaymentButton ".concat(a?"cancel-payment":"accept-payment"),type:"button",onClick:function(){return t(n,!a)},children:a?"Cancel accept":"Accept payment"})})})}),w=function(e){var t=e.username,n=e.payment,a=e.type,s=e.onAccept,c=n.data;if("history"===a)return Object(R.jsxs)("li",{className:"UserPayment Payment Border ".concat(void 0===n.newlyAccepted?"":"newly-accepted"),children:[Object(R.jsxs)("div",{className:"from-to-userpay",children:[Object(R.jsxs)("p",{className:"user",children:[" From: ",c.from_username," "]}),Object(R.jsxs)("p",{className:"user",children:[" To: ",c.to_username]})]}),Object(R.jsx)("div",{className:"title-userpay",children:Object(R.jsxs)("p",{children:["Title: ",c.title]})}),Object(R.jsxs)("div",{className:"amount-date-userpay",children:[Object(R.jsxs)("p",{children:["Amount: ",c.ammount]}),Object(R.jsxs)("p",{children:["Date: ",c.created]})]})]});if("pending"===a){var r=c.accepted.includes(t);return Object(R.jsxs)("li",{className:"UserPayment Border",children:[Object(R.jsxs)("div",{className:"Payment",children:[Object(R.jsxs)("div",{className:"from-to-userpay",children:[Object(R.jsxs)("p",{className:"user",children:[c.accepted.includes(c.from_username)?Object(R.jsx)("span",{className:"grn",children:"\u2714"}):Object(R.jsx)("span",{className:"red",children:"\ud83d\uddd9"}),"\xa0From:\xa0",c.from_username]}),Object(R.jsxs)("p",{className:"user",children:[c.accepted.includes(c.to_username)?Object(R.jsx)("span",{className:"grn",children:"\u2714"}):Object(R.jsx)("span",{className:"red",children:"\ud83d\uddd9"}),"\xa0To:\xa0",c.to_username]})]}),Object(R.jsx)("div",{className:"title-userpay",children:Object(R.jsxs)("p",{children:["Title:\xa0",c.title]})}),Object(R.jsxs)("div",{className:"amount-date-userpay",children:[Object(R.jsxs)("p",{children:["Amount:\xa0",c.ammount]}),Object(R.jsxs)("p",{children:["Date:\xa0",c.created]})]})]}),(c.waiting.includes(t)||c.accepted.includes(t))&&Object(R.jsx)(k,{onAccept:s,accepted:r,payment:n})]})}return Object(R.jsx)("div",{children:"Error in UserPayment.js!!!"})},P=n(6),L=function(e){var t=e.username,n=e.payment,a=e.type,s=e.onAccept,c=n.data;if("history"===a)return Object(R.jsxs)("li",{className:"EventPayment Payment Border ".concat(void 0===n.newlyAccepted?"":"newly-accepted"),children:[Object(R.jsx)("div",{className:"users-ammount-eventpay",children:Object.entries(c.ammounts).map((function(e){var t=Object(P.a)(e,2),n=t[0],a=t[1];return Object(R.jsxs)("p",{className:"user",children:[n," : ",a.toFixed(2)]},n)}))}),Object(R.jsx)("div",{className:"title-eventpay",children:Object(R.jsxs)("p",{children:["Title: ",c.title]})}),Object(R.jsx)("div",{className:"date-eventpay",children:Object(R.jsxs)("p",{children:["Date : ",c.created]})})]});if("pending"===a){var r=c.accepted.includes(t);return Object(R.jsxs)("li",{className:"EventPayment Border",children:[Object(R.jsxs)("div",{className:"Payment",children:[Object(R.jsx)("div",{className:"users-ammount-eventpay",children:Object.entries(c.ammounts).map((function(e){var t=Object(P.a)(e,2),n=t[0],a=t[1];return Object(R.jsxs)("p",{className:"user",children:[c.accepted.includes(n)?Object(R.jsx)("span",{className:"grn",children:"\u2714"}):Object(R.jsx)("span",{className:"red",children:"\ud83d\uddd9"})," ".concat(n)," : ",a.toFixed(2)]},n)}))}),Object(R.jsx)("div",{className:"title-eventpay",children:Object(R.jsxs)("p",{children:["Title: ",c.title]})}),Object(R.jsx)("div",{className:"date-eventpay",children:Object(R.jsxs)("p",{children:["Date: ",c.created]})})]}),(c.waiting.includes(t)||c.accepted.includes(t))&&Object(R.jsx)(k,{onAccept:s,accepted:r,payment:n})]})}return Object(R.jsx)("div",{children:"Error in EventPayment.js!!!"})},U=function(e){var t=e.username,n=e.type,a=e.header,s=e.payments,c=e.onAccept;return Object(R.jsxs)("div",{className:"PaymentList",children:[Object(R.jsx)("header",{children:a}),Object(R.jsx)("ul",{children:s.map((function(e){return"UserPayment"===e.type?Object(R.jsx)(w,{username:t,payment:e,type:n,onAccept:c},e.data.id):"EventPayment"===e.type?Object(R.jsx)(L,{username:t,payment:e,type:n,onAccept:c},e.data.id):Object(R.jsxs)("div",{children:["Error in PaymentList.js!!! payment.type: ",JSON.stringify(e)]})}))})]})},A=(n(59),function(e){var t=e.username,n=e.historyPayments,a=e.pendingPayments,s=e.onAccept;return Object(R.jsxs)("div",{className:"MainRoom",children:[Object(R.jsx)(U,{type:"history",header:"History",payments:n}),Object(R.jsx)(U,{type:"pending",header:"Pending",payments:a,username:t,onAccept:s})]})}),S=n(40),C=n(42);function _(e,t){t(parseFloat(e).toFixed(2))}var D=function(e){var t=e.userList,n=e.addUserPayment,s=Object(a.useState)(""),c=Object(P.a)(s,2),r=c[0],o=c[1],i=Object(a.useState)(t[0]),u=Object(P.a)(i,2),m=u[0],l=u[1],d=Object(a.useState)(t[0]),h=Object(P.a)(d,2),j=h[0],p=h[1],b=Object(a.useState)(0),y=Object(P.a)(b,2),O=y[0],f=y[1];return Object(R.jsxs)("div",{className:"NewUserPayment",children:[Object(R.jsx)("input",{type:"text",className:"newPay-input",placeholder:"Title",value:r,onChange:function(e){return o(e.target.value)}}),Object(R.jsxs)("label",{className:"newPay-input ftLabel",htmlFor:"NewUserPayment-from-select",children:["Select user from.",Object(R.jsx)("select",{onChange:function(e){return l(e.target.value)},name:"",id:"NewUserPayment-to-select","aria-label":"Select to",value:m,children:t.map((function(e){return Object(R.jsx)("option",{value:e,children:e},e)}))})]}),Object(R.jsxs)("label",{className:"newPay-input ftLabel",htmlFor:"NewUserPayment-to-select",children:["Select user to.",Object(R.jsx)("select",{onChange:function(e){return p(e.target.value)},name:"",id:"NewUserPayment-to-select","aria-label":"Select to",value:j,children:t.map((function(e){return Object(R.jsx)("option",{value:e,children:e},e)}))})]}),Object(R.jsx)("input",{type:"number",className:"newPay-input",value:O,onChange:function(e){return f(e.target.value)},onBlur:function(){return _(O,f)}}),Object(R.jsx)("button",{type:"button",onClick:function(){n(r,m,j,O).then((function(e){e&&(o(""),l(""),p(t[0]),f(0))}))},children:"Add Payment"})]})},T=function(e){var t=e.userList,n=e.ua,a=e.setUsernameAmmount,s=e.deleteSelf;return Object(R.jsxs)("div",{className:"NewEventPaymentPUD",children:[Object(R.jsxs)("div",{children:[Object(R.jsxs)("label",{className:"newPay-input ftLabel",htmlFor:"NewUserPayment-from-select",children:["Select user from.",Object(R.jsx)("select",{id:"NewUserPayment-to-select","aria-label":"Select to",value:""===n.username?t[0]:n.username,onChange:function(e){a(e.target.value,n.ammount)},children:t.map((function(e){return Object(R.jsx)("option",{value:e,children:e},e)}))})]}),Object(R.jsx)("input",{type:"number",className:"newPay-input",value:n.ammount,onChange:function(e){return a(n.username,e.target.value)},onBlur:function(){return _(n.ammount,(function(e){return a(n.username,e)}))}})]}),Object(R.jsx)("button",{className:"close",onClick:s,type:"button",children:"\xd7"})]})};function E(e,t){if(!(e.length>0&&e.length<250)||t.length<2)return!1;var n,a=new Map,s=Object(S.a)(t);try{for(s.s();!(n=s.n()).done;){var c=n.value,r=a.get(c.username);if(void 0===r&&a.set(c.username,1),1===r)return!1;if(c.ammount<=0)return!1}}catch(o){s.e(o)}finally{s.f()}return!0}var M=function(e){var t=e.userList,n=e.addEventPayment,s=Object(a.useState)([]),c=Object(P.a)(s,2),r=c[0],o=c[1],i=Object(a.useState)(""),u=Object(P.a)(i,2),m=u[0],l=u[1];return Object(R.jsxs)("div",{className:"NewEventPayment",children:[Object(R.jsx)("input",{type:"text",className:"newPay-input",placeholder:"Title",value:m,onChange:function(e){return l(e.target.value)}}),r.length<t.length&&Object(R.jsx)("button",{className:"add-user-to-ep",type:"button",onClick:function(){return function(e,t){e((function(e){return[].concat(Object(C.a)(e),[{username:t,ammount:"",id:Math.random()}])}))}(o,t[0])},children:"Add user to event payment"}),r.map((function(e){return Object(R.jsx)(T,{ua:e,userList:t,setUsernameAmmount:function(t,n){return function(e,t,n,a){a((function(a){return a.map((function(a){return a.id===e?{id:e,username:t,ammount:n}:a}))}))}(e.id,t,n,o)},deleteSelf:function(){return function(e,t){t((function(t){return t.filter((function(t){return t.id!==e}))}))}(e.id,o)}},e.id)})),E(m,r)&&Object(R.jsx)("button",{type:"button",onClick:function(){n(m,r).then((function(){l(""),o([])}))},children:"Add payment"})]})},I=(n(60),function(e){var t=e.userList,n=e.addUserPayment,a=e.addEventPayment;return Object(R.jsx)("div",{className:"NewPayment",children:Object(R.jsxs)("div",{className:"white-window",children:[Object(R.jsxs)("div",{className:"payment new-user-payment",children:[Object(R.jsx)("p",{className:"chose-payment",children:"User Payment"}),Object(R.jsx)("div",{className:"in-shadow-section",children:Object(R.jsx)(D,{userList:t,addUserPayment:n})})]}),Object(R.jsxs)("div",{className:"payment new-event-payment",children:[Object(R.jsx)("p",{className:"chose-payment",children:"Event Payment"}),Object(R.jsx)("div",{className:"in-shadow-section",children:Object(R.jsx)(M,{userList:t,addEventPayment:a})})]})]})})}),F=function(e){var t=e.username,n=e.isAdmin;return Object(R.jsx)("li",{children:Object(R.jsx)("p",{children:"".concat(t," is ").concat(n?"Admin":"Standard")})})},G=function(e){var t=e.username,n=e.isAdmin,a=e.changeUserRole,s=e.removeUser,c=e.myName,r=n?"Admin":"Standard",o=n?"Standard":"Admin";return Object(R.jsxs)("tr",{children:[Object(R.jsx)("td",{children:"".concat(t," is ").concat(r)}),Object(R.jsx)("td",{children:Object(R.jsx)("button",{className:"change-user-role",onClick:function(){return a(t,n?"standard":"admin")},type:"button","aria-label":"blah",disabled:t===c,children:"Make ".concat(o)})}),Object(R.jsx)("td",{children:Object(R.jsx)("button",{className:"remove-user",onClick:function(){window.confirm("Are you sure you wish to remove ".concat(t," from this room, after re-adding his saldo will reset to '0'?"))&&s(t)},type:"button","aria-label":"blah",disabled:t===c,children:"Remove from room"})})]})},B=function(e){var t=e.userList,n=e.usersRole,s=e.addUser,c=e.changeUserRole,r=e.removeUser,o=e.myName,i=Object(a.useState)(""),u=Object(P.a)(i,2),m=u[0],l=u[1];return Object(R.jsxs)("div",{children:[Object(R.jsx)("table",{children:Object(R.jsx)("tbody",{children:t.map((function(e){return Object(R.jsx)(G,{username:e,isAdmin:n[e],changeUserRole:c,removeUser:r,myName:o},e)}))})}),Object(R.jsxs)("div",{children:[Object(R.jsx)("input",{value:m,onChange:function(e){return l(e.target.value)},type:"text",placeholder:"Type username to add user to room"}),Object(R.jsx)("button",{className:"api-add-button",text:"Add user",onClick:function(){return s(m)},"aria-label":"blah",type:"button",children:"Add user"})]})]})},J=function(e){var t=e.amAdmin,n=e.userList,s=e.usersRole,c=e.addUser,r=e.roomName,o=e.setRoomName,i=e.roomDesc,u=e.setRoomDesc,m=e.changeUserRole,l=e.removeUser,d=e.myName,h=Object(a.useState)(r),j=Object(P.a)(h,2),p=j[0],b=j[1],y=Object(a.useState)(i),O=Object(P.a)(y,2),f=O[0],v=O[1];return Object(R.jsxs)("div",{className:"RoomSettings white-window",children:[Object(R.jsx)("div",{className:"section in-shadow-section",children:t?Object(R.jsx)(B,{userList:n,usersRole:s,addUser:c,changeUserRole:m,removeUser:l,myName:d}):Object(R.jsx)("ul",{className:"userList",children:n.map((function(e){return Object(R.jsx)(F,{username:e,isAdmin:s[e]})}))})}),t&&Object(R.jsxs)("div",{className:"section in-shadow-section",children:[Object(R.jsx)("input",{name:"",id:"",onChange:function(e){return b(e.target.value)},defaultValue:r}),Object(R.jsx)("button",{className:"api-add-button",onClick:function(){return o(p)},type:"button","aria-label":"blah",children:"Change room name"})]}),t?Object(R.jsxs)("div",{className:"section in-shadow-section",children:[Object(R.jsx)("textarea",{name:"",id:"",cols:"30",rows:"10",onChange:function(e){return v(e.target.value)},defaultValue:i}),Object(R.jsx)("button",{className:"api-add-button",onClick:function(){return u(f)},type:"button","aria-label":"blah",children:"Change description"})]}):Object(R.jsx)("div",{className:"section",children:i})]})};var V=function(e){var t,n=e.room,a=e.genRoomLink,s=e.leaveRoom;return Object(R.jsxs)("div",{className:"in-shadow-section flexrow",children:[Object(R.jsxs)("a",{className:"leftMyRoom",href:a(n.link),children:[Object(R.jsx)("p",{children:n.name}),Object(R.jsx)("p",{children:"Saldo: ".concat(n.saldo)}),n.is_admin?Object(R.jsx)("p",{children:"You are admin"}):null,Object(R.jsx)("p",{children:"Joined: ".concat((t=n.joined,t.replace("T"," ").replace("Z","").split(" ")[0].split("-").reverse().join("-")))})]}),Object(R.jsx)("div",{className:"rightMyRoom",children:Object(R.jsx)("button",{className:"closeButton",onClick:function(){window.confirm("Are you sure you want to leave this room?")&&s(n.link)},type:"button","aria-label":"blah",children:"\xd7"})})]})},Y=(n(61),function(e){var t=e.myRooms,n=e.genRoomLink,a=e.createRoom,s=e.leaveRoom;return console.log("render RoomCreatePick myRooms",t),Object(R.jsxs)("div",{className:"RoomCreatePick width100",children:[Object(R.jsx)("div",{className:"white-window",children:Object(R.jsx)("button",{onClick:a,type:"button","aria-label":"blah",children:Object(R.jsx)("h3",{children:"Create new room"})})}),Object(R.jsxs)("div",{className:"white-window",children:[Object(R.jsx)("h3",{children:"My rooms"}),Object(R.jsx)("div",{className:"my-rooms",children:t.length>0?t.map((function(e){return Object(R.jsx)(V,{room:e,genRoomLink:n,leaveRoom:s})})):Object(R.jsx)("h4",{children:"You have no rooms, create one or ask a friend to add you to one."})})]})]})}),q=(n(62),function(e){var t=e.LR,n=e.urlParams,a=e.baseURL,s=Object(b.e)(),c=new Map;c.set("".concat(a,"/main"),{leftLink:"".concat(a,"/new-payment").concat(n),rightLink:"".concat(a,"/settings").concat(n),leftText:"New payment",rightText:"Settings"}),c.set("".concat(a,"/new-payment"),{leftLink:"",rightLink:"".concat(a,"/main").concat(n),rightText:"Room"}),c.set("".concat(a,"/settings"),{leftLink:"".concat(a,"/main").concat(n),rightLink:"",leftText:"Room"});var r=c.get(s.pathname);return void 0===r?Object(R.jsx)(b.a,{path:"hasydewbgdffudsn"}):"left"===t&&""!==r.leftLink?Object(R.jsx)(p.b,{to:r.leftLink,className:"wallLink leftLink",children:Object(R.jsx)("div",{children:r.leftText})}):"right"===t&&""!==r.rightLink?Object(R.jsx)(p.b,{to:r.rightLink,className:"wallLink rightLink",children:Object(R.jsx)("div",{children:r.rightText})}):Object(R.jsx)("div",{style:{display:"none"}})});function H(e){var t=document.cookie.split(";");if(""===t[0])return"";for(var n in t){var a,s,c;if(a=(c=t[n].split("="))[0].trim(),s=c[1].trim(),a===e)return s}return""}n(63);var Z=function(e){Object(h.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(m.a)(this,n),(a=t.call(this,e)).props=e,a.getLocalRoomDataMaybeRemote=a.getLocalRoomDataMaybeRemote.bind(Object(d.a)(a)),a.apiGetRoomData=a.apiGetRoomData.bind(Object(d.a)(a)),a.apiGetMyRooms=a.apiGetMyRooms.bind(Object(d.a)(a)),a.apiChangeAcceptPayment=a.apiChangeAcceptPayment.bind(Object(d.a)(a)),a.apiAddUserPayment=a.apiAddUserPayment.bind(Object(d.a)(a)),a.apiAddEventPayment=a.apiAddEventPayment.bind(Object(d.a)(a)),a.apiAddUserToRoom=a.apiAddUserToRoom.bind(Object(d.a)(a)),a.apiRemoveUser=a.apiRemoveUser.bind(Object(d.a)(a)),a.apiSetRoomName=a.apiSetRoomName.bind(Object(d.a)(a)),a.apiSetRoomDesc=a.apiSetRoomDesc.bind(Object(d.a)(a)),a.apiChangeUserRole=a.apiChangeUserRole.bind(Object(d.a)(a)),a.apiNewRoom=a.apiNewRoom.bind(Object(d.a)(a)),a.apiLeaveRoom=a.apiLeaveRoom.bind(Object(d.a)(a)),a.getParams=a.getParams.bind(Object(d.a)(a)),a.handleRes=a.handleRes.bind(Object(d.a)(a)),a.render=a.render.bind(Object(d.a)(a)),a.loadData=a.loadData.bind(Object(d.a)(a)),a.state={historyPayments:[],pendingPayments:[],roomName:"",roomDesc:"",saldo:0,usersInRoom:[],usersRole:{},amAdmin:!1,myRooms:[]},a.baseURL="/payments/room",a.API_URL="https://devtgnoik.kwasnyy.pl/api/payments/v1",a.loadData(),a}return Object(l.a)(n,[{key:"handleRes",value:function(){var e=Object(u.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:if(0===(n=e.sent).err_code){e.next=6;break}return console.error(n),e.abrupt("return",!1);case 6:return this.apiGetRoomData(),e.abrupt("return",!0);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getLocalRoomDataMaybeRemote",value:function(){if(this.username=H("login"),this.token=H("token"),""===this.username&&(window.location="/login"),window.location.pathname!=="".concat(this.baseURL,"/room-create-pick"))if(["".concat(this.baseURL,"/main"),"".concat(this.baseURL,"/new-payment"),"".concat(this.baseURL,"/settings")].includes(window.location.pathname)){var e=new URL(window.location.href).searchParams.get("roomLink");console.log("roomLink",e),null!==e&&void 0!==e||(console.error("to doesnt include roomLink",window.location.to),window.location="".concat(this.baseURL,"/room-create-pick")),this.roomLink=e,this.apiGetRoomData()}else window.location="".concat(this.baseURL,"/room-create-pick")}},{key:"getParams",value:function(){return"?roomLink=".concat(this.roomLink)}},{key:"makeGenRoomLink",value:function(){var e=this.baseURL;return function(t){return"".concat(e,"/main?roomLink=").concat(t)}}},{key:"loadData",value:function(){this.getLocalRoomDataMaybeRemote(),this.apiGetMyRooms()}},{key:"apiGetRoomData",value:function(){var e=Object(u.a)(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(this.API_URL,"/get/room-data/").concat(this.roomLink,"/").concat(this.username,"/").concat(this.token));case 2:return t=e.sent,e.next=5,t.json();case 5:0===(n=e.sent).err_code?this.setState({pendingPayments:n.pending_payments,historyPayments:n.history_payments,roomName:n.room_name,roomDesc:n.room_desc,saldo:n.saldo,usersInRoom:n.users,usersRole:n.users_role,amAdmin:n.am_admin}):console.error(n);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"apiGetMyRooms",value:function(){var e=Object(u.a)(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("this",this),e.next=3,fetch("".concat(this.API_URL,"/get/my-rooms/").concat(this.username,"/").concat(this.token));case 3:return t=e.sent,e.next=6,t.json();case 6:n=e.sent,console.log("my_rooms",n),0===n.err_code?this.setState({myRooms:n.my_rooms}):console.error(n);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"apiChangeAcceptPayment",value:function(){var e=Object(u.a)(i.a.mark((function e(t,n){var a,s,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t,s="".concat(this.API_URL,"/update/set-accept-payment/").concat(this.roomLink,"/").concat(this.username,"/").concat(this.token,"/").concat(a.data.id,"/").concat(n?"accept":"unaccept"),e.next=4,fetch(s,{method:"PUT"});case 4:c=e.sent,this.handleRes(c);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"apiAddUserPayment",value:function(){var e=Object(u.a)(i.a.mark((function e(t,n,a,s){var c,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c="".concat(this.API_URL,"/post/new-payment/").concat(this.roomLink,"/").concat(this.username,"/").concat(this.token),e.next=3,fetch(c,{method:"POST",body:JSON.stringify({type:"UserPayment",data:{title:t,from_username:n,to_username:a,ammount:parseFloat(s)}})});case 3:return r=e.sent,e.abrupt("return",this.handleRes(r));case 5:case"end":return e.stop()}}),e,this)})));return function(t,n,a,s){return e.apply(this,arguments)}}()},{key:"apiAddEventPayment",value:function(){var e=Object(u.a)(i.a.mark((function e(t,n){var a,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(this.API_URL,"/post/new-payment/").concat(this.roomLink,"/").concat(this.username,"/").concat(this.token),e.next=3,fetch(a,{method:"POST",body:JSON.stringify({type:"EventPayment",data:{title:t,ammounts:Object.fromEntries(new Map(n.map((function(e){return[e.username,parseFloat(e.ammount)]}))))}})});case 3:return s=e.sent,e.abrupt("return",this.handleRes(s));case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"apiAddUserToRoom",value:function(){var e=Object(u.a)(i.a.mark((function e(t){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(this.API_URL,"/post/add-user-room/").concat(this.roomLink,"/").concat(this.username,"/").concat(this.token,"/").concat(t),e.next=3,fetch(n,{method:"POST"});case 3:a=e.sent,this.handleRes(a);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"apiRemoveUser",value:function(){var e=Object(u.a)(i.a.mark((function e(t){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(this.API_URL,"/post/remove-user-room/").concat(this.roomLink,"/").concat(this.username,"/").concat(this.token,"/").concat(t),e.next=3,fetch(n,{method:"POST"});case 3:a=e.sent,this.handleRes(a);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"apiSetRoomName",value:function(){var e=Object(u.a)(i.a.mark((function e(t){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),n="".concat(this.API_URL,"/update/room-name-desc/").concat(this.roomLink,"/").concat(this.username,"/").concat(this.token),e.next=4,fetch(n,{method:"PUT",body:JSON.stringify({roomName:t})});case 4:return a=e.sent,e.abrupt("return",this.handleRes(a));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"apiSetRoomDesc",value:function(){var e=Object(u.a)(i.a.mark((function e(t){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(this.API_URL,"/update/room-name-desc/").concat(this.roomLink,"/").concat(this.username,"/").concat(this.token),e.next=3,fetch(n,{method:"PUT",body:JSON.stringify({roomDesc:t})});case 3:a=e.sent,this.handleRes(a);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"apiChangeUserRole",value:function(){var e=Object(u.a)(i.a.mark((function e(t,n){var a,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(this.API_URL,"/update/change-user-role/").concat(this.roomLink,"/").concat(this.username,"/").concat(this.token,"/").concat(t,"/").concat(n),e.next=3,fetch(a,{method:"PUT"});case 3:return s=e.sent,e.abrupt("return",this.handleRes(s));case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"apiNewRoom",value:function(){var e=Object(u.a)(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(this.API_URL,"/post/new-room/").concat(this.username,"/").concat(this.token),e.next=3,fetch(t,{method:"POST"});case 3:return n=e.sent,e.next=6,n.json();case 6:0===e.sent.err_code&&this.apiGetMyRooms();case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"apiLeaveRoom",value:function(){var e=Object(u.a)(i.a.mark((function e(t){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(this.API_URL,"/post/leave-room/").concat(t,"/").concat(this.username,"/").concat(this.token),e.next=3,fetch(n,{method:"POST"});case 3:return a=e.sent,e.next=6,a.json();case 6:0===e.sent.err_code&&this.apiGetMyRooms();case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){return console.log("App.render()"),Object(R.jsx)(p.a,{children:Object(R.jsxs)("div",{className:"App",children:[Object(R.jsx)(b.a,{path:"".concat(this.baseURL,"/(main|new-payment|settings)"),children:Object(R.jsx)(g,{username:this.username,saldo:this.state.saldo,roomName:this.state.roomName,baseURL:this.baseURL,reload:this.apiGetRoomData})}),Object(R.jsx)(q,{baseURL:this.baseURL,LR:"left",urlParams:this.getParams()}),Object(R.jsx)(q,{baseURL:this.baseURL,LR:"right",urlParams:this.getParams()}),Object(R.jsx)(b.a,{path:"".concat(this.baseURL,"/main"),children:Object(R.jsx)(A,{username:this.username,historyPayments:this.state.historyPayments,pendingPayments:this.state.pendingPayments,onAccept:this.apiChangeAcceptPayment})}),Object(R.jsx)(b.a,{path:"".concat(this.baseURL,"/new-payment"),children:Object(R.jsx)(I,{userList:this.state.usersInRoom,addUserPayment:this.apiAddUserPayment,addEventPayment:this.apiAddEventPayment})}),Object(R.jsx)(b.a,{path:"".concat(this.baseURL,"/settings"),children:Object(R.jsx)(J,{amAdmin:this.state.amAdmin,userList:this.state.usersInRoom,usersRole:this.state.usersRole,addUser:this.apiAddUserToRoom,roomName:this.state.roomName,setRoomName:this.apiSetRoomName,roomDesc:this.state.roomDesc,setRoomDesc:this.apiSetRoomDesc,changeUserRole:this.apiChangeUserRole,removeUser:this.apiRemoveUser,myName:this.username})}),Object(R.jsx)(b.a,{path:"".concat(this.baseURL,"/room-create-pick"),children:Object(R.jsx)(Y,{myRooms:this.state.myRooms,genRoomLink:this.makeGenRoomLink(),createRoom:this.apiNewRoom,leaveRoom:this.apiLeaveRoom})}),Object(R.jsx)(N,{})]})})}}]),n}(a.Component),z=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,67)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,c=t.getLCP,r=t.getTTFB;n(e),a(e),s(e),c(e),r(e)}))};r.a.render(Object(R.jsxs)(s.a.StrictMode,{children:[Object(R.jsx)("div",{className:"unscrollable-bg"}),Object(R.jsx)(a.Suspense,{fallback:Object(R.jsx)("div",{children:"Loading..."}),children:Object(R.jsx)(Z,{})})]}),document.getElementById("root")),z()}},[[64,1,2]]]);
//# sourceMappingURL=main.8344af87.chunk.js.map